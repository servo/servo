<!DOCTYPE html>
<meta charset="utf-8">
<title>Battery Test: navigator.getBattery() is allowed in same origin iframe</title>
<link rel="author" title="Intel" href="http://www.intel.com">
<link rel="help" href="https://www.w3.org/TR/battery-status/">
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<div id="log"></div>
<iframe id="blank" src="about:blank" style="display: none"></iframe>
<script>

function load_iframe(iframe, src) {
  return new Promise((resolve, reject) => {
    iframe.onload = () => resolve(iframe);
    iframe.src = src;
  });
}

promise_test(async t => {
  let iframe = document.getElementById('blank');
  const src = 'resources/support-iframe.html';
  iframe = await load_iframe(iframe, src);
  await iframe.contentWindow.navigator.getBattery();
}, "navigator.getBattery() is allowed in same origin iframe");

</script>
