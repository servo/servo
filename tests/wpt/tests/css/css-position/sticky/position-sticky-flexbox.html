<!DOCTYPE html>
<title>position:sticky elements should work correctly with flexbox</title>
<link rel="match" href="position-sticky-flexbox-ref.html" />
<link rel="help" href="https://www.w3.org/TR/css-position-3/#sticky-pos" />
<meta name="assert" content="This test checks that position:sticky elements interoperate correctly with flexbox" />

<script src="../resources/ref-rectangle.js"></script>

<style>
.scroller {
  overflow: scroll;
  width: 350px;
  height: 100px;
  margin-bottom: 15px;
}

.flex-container {
  width: 600px;
  position: relative;
  display: flex;
  flex-flow: row wrap;
}

.sticky {
  position: sticky;
  left: 50px;
}

.green {
  background-color: green;
}

.flex-item {
  width: 100px;
  height: 85px;
  display: flex;
}

.indicator {
  position: absolute;
  background-color: red;
  width: 100px;
  height: 85px;
}
</style>

<script>
window.addEventListener('load', function() {
  document.getElementById('scroller1').scrollLeft = 50;
  document.getElementById('scroller2').scrollLeft = 150;
  document.getElementById('scroller3').scrollLeft = 250;
  createIndicatorForStickyElements(document.querySelectorAll('.sticky'));
});
</script>

<p>You should see three green boxes of varying size below. There should be no red or blue.</p>

<div id="scroller1" class="scroller">
  <div class="flex-container">
    <div class="indicator" style="left: 100px;"></div>
    <div class="flex-item"></div>
    <div class="sticky green flex-item"></div>
    <div class="green flex-item"></div>
  </div>
</div>

<div id="scroller2" class="scroller">
  <div class="flex-container">
    <div class="indicator" style="left: 200px;"></div>
    <div class="flex-item"></div>
    <div class="sticky green flex-item"></div>
    <div class="green flex-item"></div>
  </div>
</div>

<div id="scroller3" class="scroller">
  <div class="flex-container">
    <div class="indicator" style="left: 300px;"></div>
    <div class="flex-item"></div>
    <div class="sticky green flex-item"></div>
    <div class="green flex-item"></div>
  </div>
</div>
