<!doctype html>
<title>WebSockets: navigating top-level browsing context with closed websocket</title>
<meta name=timeout content=long>
<script src=/resources/testharness.js></script>
<script src=/resources/testharnessreport.js></script>
<script src=/common/utils.js></script>
<script src=../constants.sub.js></script>
<meta name="variant" content="?default">
<meta name="variant" content="?wss">
<meta name="variant" content="?wpt_flags=h2">
<p>Test requires popup blocker disabled</p>
<div id=log></div>
<script>
var t = async_test();
var w;
var uuid;
t.step(function() {
  uuid = token()
  w = window.open("002-1.html" + location.search);
  add_result_callback(function() {
    w.close();
  });
});
navigate = t.step_func(function() {
  w.location = w.location.href.replace("002-1.html", "002-2.html");
});
</script>
