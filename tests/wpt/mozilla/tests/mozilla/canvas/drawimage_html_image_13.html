<!DOCTYPE html>
<meta charset="utf-8">
<link rel=match href=drawimage_html_image_13_ref.html>
<style>
  html, body {
    margin: 0;
  }
</style>
<canvas id="dest" height="100" width="100"></canvas>
<script>

var sourceWidth = 128;
var sourceHeight = 128;
var smoothingEnabled = false;
var destCanvas = document.getElementById('dest');
var sourceImg = document.createElement('img');
sourceImg.width = sourceWidth;
sourceImg.height = sourceHeight;

var destCtx = destCanvas.getContext('2d');
destCtx.fillStyle = "#FF0000";
destCtx.fillRect(0, 0,  destCanvas.width, destCanvas.height);
destCtx.imageSmoothingEnabled = smoothingEnabled;

// The source Image doesn't have a src url defined
// It should throw an exception because the HTMLImageElement is
// in the broken state
// https://html.spec.whatwg.org/multipage/scripting.html#check-the-usability-of-the-image-argument
try {
    destCtx.drawImage(sourceImg, 0, 0);
    // It makes the test fail if the exception is not thrown
    destCtx.fillStyle = "#0000FF";
    destCtx.fillRect(0, 0,  destCanvas.width, destCanvas.height);
}
catch(err) {
  console.log("Exception: " + err.message);
}

</script>
