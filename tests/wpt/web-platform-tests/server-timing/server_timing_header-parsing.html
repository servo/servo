<!DOCTYPE html>
<!--
tests generated by:
  https://github.com/cvazac/generate-server-timing-tests
-->

<head>
    <meta charset='utf-8' />
    <script src="/resources/testharness.js"></script>
    <script src='/resources/testharnessreport.js'></script>
    <script src="/common/performance-timeline-utils.js"></script>
    <script>
      setup({explicit_done: true})
      function testServerTiming(resource, expectedResults) {
        const {serverTiming} = performance.getEntriesByName(resource)[0]
        const fileName = resource.substring(resource.lastIndexOf('/') + 1)
        test_equals(serverTiming.length, expectedResults.length, `${fileName} - count (${serverTiming.length} ?== ${expectedResults.length})`)

        expectedResults.forEach(function(expectedResult, i) {
          const dur = expectedResult.dur || 0
          const desc = expectedResult.desc || ''
          const index = expectedResults.length === 1 ? '' : `[${i}].`
          test_equals(expectedResult.name, serverTiming[i].name,
            `${fileName} - ${index}name (${expectedResult.name} ?== ${serverTiming[i].name})`)
          test_equals(dur, serverTiming[i].duration,
            `${fileName} - ${index}duration (${dur} ?== ${serverTiming[i].duration})`)
          test_equals(desc, serverTiming[i].description,
            `${fileName} - ${index}description (${desc} ?== ${serverTiming[i].description})`)
        })
      }
      for (let i = 0; i <= 83; i++) {
        var script = document.createElement('script')
        script.src = `./resources/parsing/${i}.js`
        document.getElementsByTagName('head')[0].appendChild(script)
      }
      window.addEventListener('load', done)
    </script>
</head>
