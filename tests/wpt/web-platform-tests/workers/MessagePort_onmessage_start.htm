<!DOCTYPE html>
<title> MessageChannel: port.onmessage enables message queue </title>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<div id=log></div>
<script>
async_test(function(t) {
  var channel = new MessageChannel();
  channel.port2.onmessage = t.step_func_done();
  channel.port1.postMessage("ping");
  setTimeout(t.unreached_func(), 100);
});
</script>
