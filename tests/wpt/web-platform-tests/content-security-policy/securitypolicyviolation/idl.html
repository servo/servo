<!DOCTYPE html>
<script src=/resources/testharness.js></script>
<script src=/resources/testharnessreport.js></script>
<script src=/resources/WebIDLParser.js></script>
<script src=/resources/idlharness.js></script>
<script type="text/plain" id="untested">
  enum SecurityPolicyViolationEventDisposition {
    "enforce", "report"
  };

  dictionary SecurityPolicyViolationEventInit : EventInit {
      DOMString      documentURI;
      DOMString      referrer;
      DOMString      blockedURI;
      DOMString      violatedDirective;
      DOMString      effectiveDirective;
      DOMString      originalPolicy;
      DOMString      sourceFile;
      SecurityPolicyViolationEventDisposition      disposition;
      unsigned short statusCode;
      long           lineNumber;
      long           columnNumber;
  };
</script>
<script type="text/plain" id="tested">
  [Constructor(DOMString type, optional SecurityPolicyViolationEventInit eventInitDict)]
  interface SecurityPolicyViolationEvent : Event {
      readonly    attribute DOMString      documentURI;
      readonly    attribute DOMString      referrer;
      readonly    attribute DOMString      blockedURI;
      readonly    attribute DOMString      violatedDirective;
      readonly    attribute DOMString      effectiveDirective;
      readonly    attribute DOMString      originalPolicy;
      readonly    attribute DOMString      sourceFile;
      readonly    attribute SecurityPolicyViolationEventDisposition      disposition;
      readonly    attribute unsigned short statusCode;
      readonly    attribute long           lineNumber;
      readonly    attribute long           columnNumber;
  };
</script>
<script>
  promise_test(async function() {
    let dom = await fetch('/interfaces/dom.idl').then(r => r.text());

    var idl_array = new IdlArray();
    idl_array.add_untested_idls(document.querySelector('#untested').textContent);
    idl_array.add_untested_idls(dom, { only: ['Event', 'EventInit'] });
    idl_array.add_idls(document.querySelector('#tested').textContent);
    idl_array.add_objects({
      SecurityPolicyViolationEvent: ['new SecurityPolicyViolationEvent({})']
    });
    idl_array.test();
  })
</script>
