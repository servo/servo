version: 1.0.{build}

branches:
  only:
    - master

platform:
  - x64

install:
  - set MSYSTEM=MSYS
  - set MSYS="winsymlinks=lnk"
  - C:\msys64\usr\bin\bash -lc "pacman --needed --noconfirm -Sy pacman-mirrors"
  - C:\msys64\usr\bin\bash -lc "pacman --noconfirm -Sy"
  - C:\msys64\usr\bin\bash -lc "pacman -Sy --noconfirm git mingw-w64-x86_64-toolchain mingw-w64-x86_64-freetype mingw-w64-x86_64-icu mingw-w64-x86_64-nspr mingw-w64-x86_64-ca-certificates mingw-w64-x86_64-expat mingw-w64-x86_64-cmake tar diffutils patch patchutils make python2-setuptools"
  - C:\msys64\usr\bin\easy_install-2.7 pip virtualenv
  - C:\msys64\usr\bin\bash -lc "mv /mingw64/bin/python2.exe /mingw64/bin/python2-mingw64.exe"
  - C:\msys64\usr\bin\bash -lc "mv /mingw64/bin/python2.7.exe /mingw64/bin/python2.7-mingw64.exe"

build_script:
  - C:\msys64\usr\bin\bash mach build -d
