[configs]
skip-check-length = false
skip-check-licenses = false
check-alphabetical-order = true
check-ordered-json-keys = ["./resources/prefs.json"]

# Packages which we avoid using in Servo.
# For each blocked package, we can list the exceptions,
# which are packages allowed to use the blocked package.
[blocked-packages]
num = []
rand = [
    "ipc-channel",
    "phf_generator",
    "quickcheck", # Only used in tests
    "servo_rand",
    "tungstenite",
]

[ignore]
# Ignored packages with duplicated versions
packages = [
    "arrayvec",
    "base64",
    "cfg-if",
    "cookie",
    "itoa",
    "libloading",
    "num-rational",
    "parking_lot",
    "parking_lot_core",
    "redox_syscall",
    "ron",
    "time",
    "wasi",
    "wayland-sys",
    "bitflags",

    # Duplicated by rustls and image.
    "spin",

    # Duplicated by rustls and the version of webpki-roots required by async_tungstenite.
    "rustls-webpki",

    # https://github.com/servo/servo/issues/26933
    "futures",
    "mio",

    # https://github.com/servo/servo/pull/23288#issuecomment-494687746
    "gl_generator",

    # https://github.com/servo/servo/pull/25518
    "core-foundation",
    "core-foundation-sys",
    "lyon_geom",

    # https://github.com/servo/servo/pull/28236
    "nix",

    # Duplicated by surfman/wgpu update.
    "bitflags",
    "windows-sys",
    "windows-targets",
    "windows_aarch64_gnullvm",
    "windows_aarch64_msvc",
    "windows_i686_gnu",
    "windows_i686_msvc",
    "windows_x86_64_gnu",
    "windows_x86_64_msvc",
    "windows_x86_64_gnullvm",

    # wgpu has the latest and greates
    "paste",
    "syn",
    "metal",
    "foreign-types",
    "foreign-types-shared",

    # Temporarily duplicated until gleam can be upgrded.
    "uuid",

    # winit port minibrowser (servo/servo#30049)
    "clipboard-win",
    "ahash",
]
# Files that are ignored for all tidy and lint checks.
files = [
    "./components/net/tests/parsable_mime/text",
    # Ignore style files to avoid diverging too much from upstream Gecko
    "./components/style/",
    "./components/style_derive/parse.rs",
    "./resources/hsts_preload.json",
    "./tests/wpt/meta/MANIFEST.json",
    "./tests/wpt/meta-legacy-layout/MANIFEST.json",
    "./tests/wpt/mozilla/meta/MANIFEST.json",
    "./tests/wpt/mozilla/meta-legacy-layout/MANIFEST.json",
    # Long encoded string
    "./tests/wpt/mozilla/tests/mozilla/resources/brotli.py",
    "./tests/wpt/webgl/meta/MANIFEST.json",
    # Upstream code from Khronos/WebGL uses tabs for indentation
    "./tests/wpt/webgl/tests",
    # Vendored from upstream
    "./tests/wpt/webgpu/tests",
    # Our import script is not currently respecting the lint.
    "./tests/wpt/webgl/tools/import-conformance-tests.py",
    # Ignore those files since the issues reported are on purpose
    "./tests/html/bad-line-ends.html",
    "./tests/wpt/mozilla/tests/css/fonts",
    "./tests/wpt/mozilla/tests/css/pre_with_tab.html",
    "./tests/wpt/mozilla/tests/mozilla/textarea_placeholder.html",
    # Python 3 syntax causes "E901 SyntaxError" when flake8 runs in Python 2
    "./components/style/properties/build.py",
    # The tidy tests currently don't pass tidy.
    "./python/tidy/test.py",
]
# Directories that are ignored for the non-WPT tidy check.
directories = [
    # Upstream
    "./support/android/apk",
    "./tests/wpt/harness",
    "./tests/wpt/tests",
    "./tests/wpt/mozilla/tests/mozilla/referrer-policy",
    "./tests/wpt/mozilla/tests/webgl",
    "./python/tidy/tests",
    "./python/_virtualenv*",
    "./python/mach",
    # Generated and upstream code combined with our own. Could use cleanup
    "./target",
    "./third_party",
]

# Directories that are checked for correct file extension
[check_ext]
# directory, list of expected file extensions
"./components/script/dom/webidls" = [".webidl", "noidl"]
